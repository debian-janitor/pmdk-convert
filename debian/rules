#!/usr/bin/make -f

export DEB_BUILD_MAINT_OPTIONS = hardening=+all

DEB_HOST_MULTIARCH ?= $(shell dpkg-architecture -qDEB_HOST_MULTIARCH)
DEB_UPSTREAM_VERSION = $(shell dpkg-parsechangelog -S version | cut -d - -f 1 | cut -d : -f 2)

override_dh_auto_configure:
	for v in 1.0 1.1 1.2 1.3 1.4 1.5;do ln -sf nvml/nvml-$$v nvml-$$v;done
	for v in `grep 'set(NVML' CMakeLists.txt |cut -d' ' -f2|tr -d ')'`;do touch nvml-$$v.tar.gz;done
	dh_auto_configure -- -DCMAKE_BUILD_TYPE=RelWithDebInfo -DTESTS_USE_FORCED_PMEM=1

%:
	dh $@
